# The MATSim Switzerland Railway Scenario

![Build Status](https://github.com/matsim-scenarios/matsim-switzerland-railway/workflows/build/badge.svg?branch=main)
![license](https://img.shields.io/github/license/matsim-scenarios/matsim-switzerland-railway.svg)
![JDK](https://img.shields.io/badge/JDK-17+-green.svg)


![Switzerland railway network and agents](docs/img/visualization_ch_network.png "Switzerland railway network and agents")


----

### About this project

This repository provides a MATSim model for Switzerland's railway developed by Swiss Federal Railways (Schweizerische Bundesbahnen, SBB), Corporate Development.

Developers/Contributors: Merlin Unterfinger, Thomas Hettinger, Ihab Kaddoura

<a rel="SBB" href="www.sbb.ch"><img src="docs/img/logo_sbb.png" width="200" /></a>

### Licenses

The **MATSim program code** in this repository is distributed under the terms of the [GNU Affero General Public License v3.0](https://www.gnu.org/licenses/agpl-3.0.html.en). The MATSim program code are files that reside in the `src` directory hierarchy and typically end with `*.java`.

The **MATSim input files, output files, analysis data and visualizations** are licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br /> MATSim input files are those that are used as input to run MATSim. They often, but not always, have a header pointing to matsim.org. They typically reside in the `matsim_input` or `scenarios` directory hierarchy. MATSim output files, analysis data, and visualizations are files generated by MATSim runs, or by postprocessing.  They typically reside in a directory hierarchy starting with `output`.

**Other data files**, in particular in `original_data`, have their own individual licenses that need to be individually clarified with the copyright holders.


----
### Prepare the MATSim input files
1. Switch to the branch `prepare`. (Currently, the preparation requires an older MATSim version than the railsim contribution. So, we can't have everything in one branch. So, for now, we have to deal with two different branches.)
1. Download the OSM and GTFS file. For some useful links, have a look into the info files in the `original_data` directory.
1. Process the OSM input file (optional), e.g. use osmosis. For some useful links and some help, have a look into the info files in the `original_data` directory.
1. Put the GTFS and (processed) OSM file into the `original_data` directory.
1. Run the JAVA class located in `src/main/java/ch/sbb/prepare`. The preparation makes use of the pt2matsim repository.

----
### Run the MATSim Switzerland Railway scenario

##### ... using an IDE, e.g. Eclipse, IntelliJ - Alternative 1: use cloned/downloaded matsim-[name] repository
(Requires either cloning or downloading the repository.)

1. Set up the project in your IDE.
1. Make sure the project is configured as maven project.
1. Run the JAVA class `src/main/java/ch/sbb/run/RunSwitzerlandRailway.java`.
1. "Open" the output directory.  You can drag files into VIA as was already done above.
1. Edit the config file or adjust the run class. Re-run MATSim.

##### ... using a runnable jar file
(Requires either cloning or downloading the repository and java)

1. Open the cmd and go to your project directory
2. Build the scenario using `mvnw package` 
3. There should be a  `<...>.jar` file directly in the main directory.
4. Run this file from the command line using `java -jar <...>.jar --help` to see all possible options.
    1. For example, one can disable lanes or run the 25pct scenario using the available options
5. Start this scenario using the default config by running `java -jar <...>.jar`
6. "Open" the output directory.  You can drag files into VIA as was already done above.
